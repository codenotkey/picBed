{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Dragger","Upload","Result","styled","div","H1","h1","Image","img","Dt","dt","Component","observer","useStores","ImageStore","UserStore","store","useRef","useLocalStore","width","height","setWidth","setHeight","serverFile","attributes","url","WidthStr","heightStr","props","showUploadList","beforeUpload","file","setFilename","name","setFile","currentUser","message","warn","test","type","size","error","upload","then","info","catch","err","tip","spinning","isUploading","className","InboxOutlined","target","href","style","shape","onClick","value","copy","filename","src","Tips","children","Home","Uploader"],"mappings":"wPAQOA,EAAWC,IAAXD,QAEDE,EAASC,IAAOC,IAAV,+FAMNC,EAAKF,IAAOG,GAAV,2EAKFC,EAAQJ,IAAOK,IAAV,kDAILC,EAAKN,IAAOO,GAAV,wEAmHOC,EA7GGC,aAAS,WACvB,MAA+BC,cAAxBC,EAAP,EAAOA,WAAWC,EAAlB,EAAkBA,UAIZC,GAHQC,mBACDA,mBAECC,aAAc,iBAAK,CAC7BC,MAAM,KACNC,OAAO,KAEPC,SAJ6B,SAIpBF,GACLH,EAAMG,MAAQA,GAElBG,UAP6B,SAOnBF,GACNJ,EAAMI,OAASA,GAGnB,eACI,OAAOJ,EAAMG,MAAN,aAAkBH,EAAMG,OAAQ,IAE3C,gBACI,OAAOH,EAAMI,OAAN,aAAmBJ,EAAMI,QAAS,IAE7C,cACI,OAAON,EAAWS,WAAWC,WAAWC,IAAID,WAAWC,IAAM,gBAAkBT,EAAMU,SAAWV,EAAMW,gBAaxGC,EAAM,CACRC,gBAAe,EACfC,aAAa,SAAAC,GAGT,OAFAjB,EAAWkB,YAAYD,EAAKE,MAC5BnB,EAAWoB,QAAQH,GACU,OAA1BhB,EAAUoB,aACTC,IAAQC,KAAK,+CACN,GAEN,wCAAwCC,KAAKP,EAAKQ,MAInDR,EAAKS,KAAO,SACZJ,IAAQK,MAAM,+BACP,IAEX3B,EAAW4B,SACNC,MAAK,SAACpB,GACHa,IAAQQ,KAAK,0EAEdC,OAAM,SAACC,GAGVV,IAAQK,MAAM,gCAEV,IAhBJL,IAAQK,MAAM,0EACP,KAmBnB,OACI,gCACI,cAAC,IAAD,CAAMM,IAAK,qBAAOC,SAAUlC,EAAWmC,YAAvC,SACI,eAACjD,EAAD,2BAAa4B,GAAb,cACI,mBAAGsB,UAAU,uBAAb,SACI,cAACC,EAAA,EAAD,MAEJ,mBAAGD,UAAU,kBAAb,kGACA,mBAAGA,UAAU,kBAAb,0HAMJpC,EAAWS,WAAa,eAACrB,EAAD,WACpB,cAACG,EAAD,uCACA,+BACI,cAACI,EAAD,uCACA,6BACI,mBAAG2C,OAAO,SAASC,KAAMvC,EAAWS,WAAWC,WAAWC,IAAID,WAAWC,IAAK6B,MAAO,CAACnC,MAAM,QAA5F,SAAuGL,EAAWS,WAAWC,WAAWC,IAAID,WAAWC,QAE3J,6BAAI,cAAC,IAAD,CAAQc,KAAK,UAAUgB,MAAM,QAAQC,QAAS,kBAvDnDC,EAuDkE3C,EAAWS,WAAWC,WAAWC,IAAID,WAAWC,IAtDjIiC,IAAKD,QACLrB,IAAQQ,KAAK,wCAFC,IAACa,GAuDK,wCACJ,cAAChD,EAAD,iCACA,6BAAKK,EAAW6C,WAChB,cAAClD,EAAD,uCACA,6BACI,cAACF,EAAD,CAAOqD,IAAK9C,EAAWS,WAAWC,WAAWC,IAAID,WAAWC,cAW5D,WChItBoC,EAAM1D,IAAOC,IAAT,iLAqBMO,EAXEC,aAAS,YAAe,IAAbkD,EAAY,EAAZA,SACjB/C,EAAeF,cAAfE,UACR,OACI,mCAEQA,EAAUoB,YAAY,KAAK,cAAC0B,EAAD,UAAOC,SCTnCC,UARf,WACI,OACI,qCACI,cAAC,EAAD,+DACA,cAACC,EAAD","file":"static/js/10.5f3d4eb2.chunk.js","sourcesContent":["import React, {useRef} from \"react\";\r\nimport {observer, useLocalStore} from \"mobx-react\";\r\nimport {Upload, message, Spin,Progress,Button} from 'antd'\r\nimport {useStores} from \"../stores\";\r\nimport styled from \"styled-components\";\r\nimport { InboxOutlined } from '@ant-design/icons';\r\nimport copy from \"copy-to-clipboard\";\r\n\r\nconst {Dragger} = Upload\r\n\r\nconst Result = styled.div`\r\n  margin-top: 10px;\r\n  border: 1px dashed #ccc;\r\n  padding: 20px;\r\n`\r\n\r\nconst H1 = styled.h1` \r\n    margin: 20px 0;\r\n    text-align: center;\r\n`\r\n\r\nconst Image = styled.img`\r\n   max-width: 300px;\r\n`\r\n\r\nconst Dt = styled.dt`\r\n  font-weight: bolder;\r\n  font-size: 16px;\r\n`\r\n\r\n\r\nconst Component = observer(()=>{\r\n    const {ImageStore,UserStore} = useStores()\r\n    const  ref1 = useRef()\r\n    const ref2 = useRef()\r\n\r\n    const store = useLocalStore(()=>({\r\n        width:null,\r\n        height:null,\r\n\r\n        setWidth(width){\r\n            store.width = width\r\n        },\r\n        setHeight(height){\r\n            store.height = height\r\n        },\r\n\r\n        get WidthStr(){\r\n            return store.width?`/w/${store.width}`:''\r\n        },\r\n        get heightStr(){\r\n            return store.height?`/h/${store.height}`:''\r\n        },\r\n        get fullStr(){\r\n            return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.WidthStr + store.heightStr\r\n        }\r\n    }))\r\n    const bindWidthChange = ()=>{\r\n        store.setWidth(ref1.current.value)\r\n    }\r\n    const bindHeightChange = ()=>{\r\n        store.setHeight(ref2.current.value)\r\n    }\r\n    const handleCopy= (value) =>{\r\n        copy(value)\r\n        message.info('链接复制成功')\r\n    }\r\n    const props={\r\n        showUploadList:false,\r\n        beforeUpload:file =>{\r\n            ImageStore.setFilename(file.name)\r\n            ImageStore.setFile(file)\r\n            if(UserStore.currentUser === null){\r\n                message.warn('登录之后再上传')\r\n                return false\r\n            }\r\n            if (!/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/ig.test(file.type)) {\r\n                message.error('只能上传png/svg/jpg/gif格式的图片');\r\n                return false;\r\n            }\r\n            if (file.size > 1024 * 1024) {\r\n                message.error('图片最大1M');\r\n                return false;\r\n            }\r\n            ImageStore.upload()\r\n                .then((serverFile)=>{\r\n                    message.info('上传成功,请等待链接显示')\r\n                    // console.log(serverFile);\r\n                }).catch((err)=>{\r\n                // console.log(err);\r\n                // console.log(ImageStore.filename)\r\n                message.error('上传失败')\r\n            })\r\n            return  false\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <Spin tip={'上传中'} spinning={ImageStore.isUploading}>\r\n                <Dragger {...props} >\r\n                    <p className=\"ant-upload-drag-icon\">\r\n                        <InboxOutlined />\r\n                    </p>\r\n                    <p className=\"ant-upload-text\">点击或者拖拽文件到此区域上传</p>\r\n                    <p className=\"ant-upload-hint\">\r\n                        只能上传png/svg/jpg/gif格式的图片,图片最大1M。\r\n                    </p>\r\n                </Dragger>\r\n            </Spin>\r\n            {\r\n                ImageStore.serverFile ? <Result>\r\n                    <H1>上传结果</H1>\r\n                    <dl>\r\n                        <Dt>线上地址</Dt>\r\n                        <dd>\r\n                            <a target=\"_blank\" href={ImageStore.serverFile.attributes.url.attributes.url} style={{width:'50px'}}>{ ImageStore.serverFile.attributes.url.attributes.url}</a>\r\n                        </dd>\r\n                        <dt><Button type=\"primary\" shape=\"round\" onClick={()=>handleCopy(ImageStore.serverFile.attributes.url.attributes.url)}>复制链接</Button></dt>\r\n                        <Dt>文件名</Dt>\r\n                        <dd>{ImageStore.filename}</dd>\r\n                        <Dt>图片预览</Dt>\r\n                        <dd>\r\n                            <Image src={ImageStore.serverFile.attributes.url.attributes.url}/>\r\n                        </dd>\r\n                        {/*<dt>更多尺寸</dt>*/}\r\n                        {/*<dd>*/}\r\n                        {/*    <input ref={ref1} onChange={bindWidthChange} placeholder=\"最大宽度（可选）\"/>*/}\r\n                        {/*    <input ref={ref2} onChange={bindHeightChange} placeholder=\"最大高度（可选）\"/>*/}\r\n                        {/*</dd>*/}\r\n                        {/*<dd>*/}\r\n                        {/*    <a  target=\"_blank\" href={store.fullStr}>{store.fullStr}</a>*/}\r\n                        {/*</dd>*/}\r\n                    </dl>\r\n                </Result> : null\r\n            }\r\n        </div>\r\n    )\r\n})\r\n\r\nexport default Component\r\n","import React from \"react\";\r\nimport {observer} from 'mobx-react'\r\nimport {useStores} from \"../stores\";\r\nimport styled from \"styled-components\";\r\n\r\n\r\nconst Tips =styled.div`\r\n  background-color: #ff4d4f;\r\n  padding: 10px;\r\n  margin: 30px 0;\r\n  color: #fff;\r\n  border-radius: 4px;\r\n  text-align: center;\r\n  font-size: 16px;\r\n`\r\n\r\nconst Component = observer(({children})=>{\r\n    const { UserStore }  = useStores()\r\n    return(\r\n        <>\r\n            {\r\n                UserStore.currentUser?null:<Tips>{children}</Tips>\r\n            }\r\n        </>\r\n    )\r\n})\r\n\r\nexport  default Component\r\n","import React from \"react\";\r\nimport Uploader from \"../components/Uploader\";\r\nimport Tips from \"../components/Tips\";\r\n\r\nfunction Home(){\r\n    return(\r\n        <>\r\n            <Tips>登录以后方可使用</Tips>\r\n            <Uploader/>\r\n        </>\r\n    )\r\n}\r\nexport default Home\r\n"],"sourceRoot":""}